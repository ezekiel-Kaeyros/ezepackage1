(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{771:function(){},3169:function(t,e,a){Promise.resolve().then(a.bind(a,7732))},7732:function(t,e,a){"use strict";a.r(e),a.d(e,{UploadFile:function(){return F}});var r=a(7437),i=a(2173),o=a(4131),s=a.n(o),n=a(771),l=a.n(n),c=a(9743),u=a.n(c),d=a(2601),h=a(7133).Buffer;class p{async getFileDetails(){let t=u().basename(this.filePath),e=u().join(d.cwd(),this.filePath);console.log("this is my fileContent",this.filePath);let a=l().readFileSync(e);console.log("this is my fileContent02");let r=l().statSync(e),i=r.size,o=Math.floor(r.mtimeMs),n=s().createHash("md5");return n.update(a),{filename:t,filesize:i,mtime:o,md5Hash:n.digest("hex")}}async getAllUserGroups(){let t="".concat(this.baseUrl,"/users/").concat(this.userId,"/groups/"),e={Authorization:"Bearer ".concat(this.apiKey)};return i.Z.get(t,{headers:e})}async getItemById(t){if(null===t)return{error:"`item_id` cannot be null",status:400};let e="".concat(this.baseUrl,"/groups/").concat(this.groupId,"/items/").concat(t),a={Authorization:"Bearer ".concat(this.apiKey)};return i.Z.get(e,{headers:a})}async postParentItem(){let t="".concat(this.baseUrl,"/groups/").concat(this.groupId,"/items/"),e=JSON.stringify([{itemType:"book",title:this.itemTitle,creators:[{creatorType:"author",firstName:this.authorName,lastName:this.authorName}],tags:[],collections:[],relations:{},date:"2024",url:"http://example.com/sample-document",accessDate:"2024-06-20"}]),a={Authorization:"Bearer ".concat(this.apiKey),"Content-Type":"application/json"};try{return await i.Z.post(t,e,{headers:a})}catch(t){var r;return{error:"Failed To Create File Environment",status:(null===(r=t.response)||void 0===r?void 0:r.status)||null}}}async postChildItem(){if(!this.itemType||!this.itemTitle)return{error:"`item_type` and `item_title` cannot be null",status:400};let t=await this.postParentItem();if("error"in t)return t;let e=this.convertDateFormat(this.accessDate),a="".concat(this.baseUrl,"/groups/").concat(this.groupId,"/items/"),r=JSON.stringify([{itemType:"attachment",parentItem:t.data.successful[0].data.key,linkMode:"imported_file",title:this.itemTitle,accessDate:e,url:this.coverPageUrl,note:this.note,tags:[],relations:{},contentType:"application/pdf",charset:"",filename:this.filename,md5:null,mtime:null}]),o={Authorization:"Bearer ".concat(this.apiKey),"Content-Type":"application/json"};try{return await i.Z.post(a,r,{headers:o})}catch(t){var s;return{error:"Unable To Create File Environment",status:(null===(s=t.response)||void 0===s?void 0:s.status)||null}}}convertDateFormat(t){let e=new Date(t),a=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),i=String(e.getUTCDate()).padStart(2,"0"),o=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),n=String(e.getUTCSeconds()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(i,"T").concat(o,":").concat(s,":").concat(n,"Z")}async getUploadAuthorization(){let t=await this.postChildItem();if("error"in t)return t;let e="".concat(this.baseUrl,"/groups/").concat(this.groupId,"/items/").concat(t.data.successful[0].key,"/file"),{filename:a,filesize:r,mtime:o,md5Hash:s}=await this.getFileDetails(),n="md5=".concat(s,"&filename=").concat(a,"&filesize=").concat(r,"&mtime=").concat(o),l={"If-None-Match":"*",Authorization:"Bearer ".concat(this.apiKey),"Content-Type":"application/x-www-form-urlencoded"};try{let a=await i.Z.post(e,n,{headers:l});return a.data.child_item_id=t.data.successful[0].key,{response:a,result:a.data}}catch(t){var c;return{error:"Cannot Get Upload Authorization",status:(null===(c=t.response)||void 0===c?void 0:c.status)||null}}}async uploadFile(){let t=await this.getUploadAuthorization();if("error"in t)return t;let{response:e,result:a}=t;if(200!==e.status)return{error:"Upload Authorization Rejected",status:e.status};let r=l().readFileSync(this.filePath),o=h.concat([h.from(a.prefix),r,h.from(a.suffix)]);try{let t=await i.Z.post(a.url,o,{headers:{"Content-Type":a.contentType}});if(201!==t.status)return{error:"Failed To Upload File To s3",status:t.status};return{response:"Successful Upload To Zotero s3",extra_data:{item_id:a.child_item_id,upload_key:a.uploadKey},status:t.status}}catch(t){var s;return{error:"Failed To Upload File To s3",status:(null===(s=t.response)||void 0===s?void 0:s.status)||null}}}async registerUpload(){let t=await this.uploadFile();if("error"in t)return t;let e="".concat(this.baseUrl,"/groups/").concat(this.groupId,"/items/").concat(t.extra_data.item_id,"/file"),a="upload=".concat(t.extra_data.upload_key),r={"If-None-Match":"*",Authorization:"Bearer ".concat(this.apiKey),"Content-Type":"application/x-www-form-urlencoded"};try{let t=await i.Z.post(e,a,{headers:r});if(204!==t.status)return{error:"File Uploaded To Zotero s3 but Zotero Failed To Register File",status:t.status};return t}catch(t){var o;return{error:"File Uploaded To Zotero s3 but Zotero Failed To Register File",status:(null===(o=t.response)||void 0===o?void 0:o.status)||null}}}constructor(t="https://api.zotero.org",e="ljJwZLSkS26ymt6DFd5D2Blc",a=14487670,r=5577831,i="/zoteroFiles/UnderstandMenNow.pdf",o="",s=null,n=null,l=null,c=u().basename(i),d="",h=new Date().toISOString()){this.baseUrl=t,this.groupId=r,this.userId=a,this.apiKey=e,this.filePath=i,this.coverPageUrl=o,this.itemTitle=s,this.itemType=n,this.authorName=l,this.filename=c,this.note=d,this.accessDate=h}}var m=a(6061);a(2265);var f=a(6691),y=a.n(f),g=a(7042),w=a(5769);let v=(0,m.j)("w-full  text-white font-medium py-4 flex justify-center px-4 focus:outline-none focus:shadow-outline",{variants:{variant:{default:"bg-primaryColor  text-white hover:opacity-90",primary:"bg-primaryColor  text-white hover:opacity-90 rounded-lg",secondary:"bg-[#EEF3FB] hover:opacity-90 text-[#2C353A]",danger:"bg-red-500 w-full text-white hover:bg-red-600",outline:"bg-white w-full text-primaryColor01 border border-primaryColor01 hover:opacity-70 rounded-lg",disabled:"bg-primaryColor  opacity-50 w-full text-white",active:"bg-primaryColor  opacity-50 w-full text-white"}},defaultVariants:{variant:"default"}}),T=t=>{let{variant:e,className:a,href:i,icon:o,children:s,...n}=t;return i?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{...n,className:function(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return(0,w.m)((0,g.W)(e))}(v({variant:e,className:a})),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:o?(0,r.jsx)(y(),{src:o,alt:"Icon"}):""}),s]})})})},F=()=>{let t=new p("https://api.zotero.org","ljJwZLSkS26ymt6DFd5D2Blc",14487670,5577831,"/zoteroFiles/UnderstandMenNow.pdf","","4hrs Deep Everyday","attachment","The New Author","this is my fileName","legend of the seeker"),e=async()=>{try{let e=await t.registerUpload();console.log("File uploaded successfully:",e)}catch(t){console.error("Error uploading file:",t)}};return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(T,{className:"w-fit rounded-md",onClick:e,children:"Upload File"})})}}},function(t){t.O(0,[218,691,173,87,756,971,938,744],function(){return t(t.s=3169)}),_N_E=t.O()}]);